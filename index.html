<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Express Shopping</title>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAP8RwZdXy3RzS9gsZvFANyW1KEVgSheTo",
            authDomain: "express-for-luxury-products.firebaseapp.com",
            projectId: "express-for-luxury-products",
            storageBucket: "express-for-luxury-products.firebasestorage.app",
            messagingSenderId: "92621831338",
            appId: "1:92621831338:web:c479787725b89287b8e4d3",
            measurementId: "G-DYN87STLK1"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function loadProducts() {
            const container = document.getElementById('productsContainer');
            try {
                const q = query(collection(db, "products"), orderBy("createdAt", "desc"));
                const querySnapshot = await getDocs(q);
                container.innerHTML = ""; 

                querySnapshot.forEach((doc) => {
                    const item = doc.data();
                    const productHTML = `
                        <div class="product-card">
                            <div class="image-container">
                                <img src="${item.imageUrl}" alt="${item.name_ar}">
                            </div>
                            <div class="product-info">
                                <h3>${item.name_ar}</h3>
                                <p class="price"><span>${item.price}</span> ريال</p>
                                <a href="${item.link || '#'}" class="buy-button">اطلب الآن عبر واتساب</a>
                            </div>
                        </div>`;
                    container.innerHTML += productHTML;
                });
            } catch (e) { console.error(e); }
        }

        window.addNewProduct = async function(e) {
            e.preventDefault();
            const pass = prompt("كلمة مرور الإدارة:");
            if(pass !== "4004") return alert("خطأ!");

            await addDoc(collection(db, "products"), {
                name_ar: document.getElementById('p_name').value,
                price: document.getElementById('p_price').value,
                imageUrl: document.getElementById('p_img').value,
                link: document.getElementById('p_link').value,
                createdAt: new Date()
            });
            alert("تم الحفظ بنجاح!");
            location.reload();
        };

        window.onload = loadProducts;
    </script>

    <style>
        /* تصميمك المرتب والأنيق */
        body { font-family: 'Cairo', sans-serif; background-color: #f4f7f6; margin: 0; padding: 20px; }
        
        .admin-section { 
            background: #fff; padding: 25px; border-radius: 20px; 
            max-width: 500px; margin: 0 auto 40px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); border: 1px solid #eee;
        }

        .products-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); 
            gap: 25px; max-width: 1200px; margin: 0 auto;
        }

        .product-card { 
            background: white; border-radius: 18px; overflow: hidden; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.08); transition: 0.3s;
            display: flex; flex-direction: column;
        }

        .product-card:hover { transform: translateY(-10px); }

        .image-container { width: 100%; height: 220px; overflow: hidden; }
        .image-container img { width: 100%; height: 100%; object-fit: cover; }
        
        .product-info { padding: 20px; text-align: center; }
        .product-info h3 { margin: 0 0 10px; font-size: 1.1rem; color: #333; }
        
        .price { color: #27ae60; font-weight: bold; font-size: 1.3em; margin-bottom: 15px; }
        
        .buy-button { 
            display: block; padding: 12px; background: #25d366; 
            color: white; border-radius: 12px; text-decoration: none; 
            font-weight: bold; transition: 0.2s;
        }
        .buy-button:hover { background: #1ebd56; }

        input { display: block; width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; }
    </style>
</head>
<body>

    <h1 style="text-align:center; color:#2c3e50; margin-bottom:40px;">Express Shopping</h1>

    <div class="admin-section">
        <h3 style="text-align:center; margin-top:0;">إضافة منتج جديد</h3>
        <form onsubmit="addNewProduct(event)">
            <input type="text" id="p_name" placeholder="اسم المنتج" required>
            <input type="number" id="p_price" placeholder="السعر" required>
            <input type="text" id="p_img" placeholder="رابط الصورة" required>
            <input type="text" id="p_link" placeholder="رابط الواتساب">
            <button type="submit" style="width:100%; padding:12px; background:#007bff; color:white; border:none; border-radius:10px; cursor:pointer; font-weight:bold;">نشر المنتج الآن</button>
        </form>
    </div>

    <div id="productsContainer" class="products-grid"></div>

</body>
</html>

